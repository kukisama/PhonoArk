<!--pages/exam/exam.wxml-->
<view class="exam-page">

  <!-- è€ƒè¯•è®¾ç½®ç•Œé¢ -->
  <view class="setup-section" wx:if="{{examState === 'setup'}}">
    <view class="setup-hero">
      <text class="setup-icon">ğŸ“</text>
      <text class="setup-title">éŸ³æ ‡è€ƒè¯•</text>
      <text class="setup-desc">å¬å•è¯å‘éŸ³ï¼Œé€‰æ‹©å¯¹åº”çš„éŸ³æ ‡</text>
    </view>

    <view class="setup-card">
      <view class="setup-row">
        <text class="setup-label">é¢˜ç›®æ•°é‡</text>
        <picker
          mode="selector"
          range="{{['5', '10', '15', '20', '30']}}"
          value="{{1}}"
          bindchange="onCountChange"
        >
          <view class="picker-value">{{questionCount}} é¢˜ â–¼</view>
        </picker>
      </view>
    </view>

    <view class="setup-action">
      <view class="btn-start" bindtap="startExam">å¼€å§‹è€ƒè¯•</view>
    </view>
  </view>

  <!-- ç­”é¢˜ç•Œé¢ -->
  <view class="active-section" wx:if="{{examState === 'active'}}">
    <!-- è¿›åº¦æ¡ -->
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{progress}}%"></view>
    </view>

    <!-- é¢˜å·ä¸è¿›åº¦ -->
    <view class="question-header">
      <text class="question-number">ç¬¬ {{currentIndex + 1}} é¢˜ / å…± {{questions.length}} é¢˜</text>
    </view>

    <!-- é¢˜ç›®åŒºåŸŸï¼šå•è¯å±•ç¤º -->
    <view class="question-card">
      <text class="question-word">{{currentQuestion.word}}</text>
      <text class="question-ipa">{{currentQuestion.wordIpa}}</text>
      <view class="replay-btn" bindtap="onReplay">
        <text>ğŸ”Š å†å¬ä¸€é</text>
      </view>
    </view>

    <!-- æç¤º -->
    <view class="question-hint">
      <text>è¯·é€‰æ‹©è¯¥å•è¯æ‰€å±çš„éŸ³æ ‡ï¼š</text>
    </view>

    <!-- é€‰é¡¹åˆ—è¡¨ -->
    <view class="options-list">
      <view
        wx:for="{{currentQuestion.options}}"
        wx:key="symbol"
        class="option-btn {{showFeedback && item.isCorrect ? 'option-correct' : ''}} {{showFeedback && selectedOption === index && !item.isCorrect ? 'option-wrong' : ''}} {{!showFeedback && selectedOption === index ? 'option-selected' : ''}}"
        data-index="{{index}}"
        bindtap="onSelectOption"
      >
        <text class="option-symbol">{{item.symbol}}</text>
      </view>
    </view>

    <!-- åé¦ˆæç¤º -->
    <view class="feedback" wx:if="{{showFeedback}}">
      <view class="feedback-content {{isCorrect ? 'feedback-correct' : 'feedback-wrong'}}">
        <text class="feedback-icon">{{isCorrect ? 'âœ…' : 'âŒ'}}</text>
        <text class="feedback-text">{{isCorrect ? 'å›ç­”æ­£ç¡®ï¼' : 'å›ç­”é”™è¯¯ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ ' + currentQuestion.correctSymbol}}</text>
      </view>
    </view>
  </view>

</view>
